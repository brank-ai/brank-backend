{
  "info": {
    "name": "Brank Backend API",
    "description": "Backend API for Brank - Brand visibility metrics across 4 major LLMs (ChatGPT, Gemini, Grok, Perplexity)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "health"
          ]
        },
        "description": "Health check endpoint to verify the API is running.\n\n**Response:**\n```json\n{\n  \"status\": \"healthy\"\n}\n```"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "health"
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"status\": \"healthy\"\n}"
        }
      ]
    },
    {
      "name": "Get Brand Metrics",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/metric?website={{website}}",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "metric"
          ],
          "query": [
            {
              "key": "website",
              "value": "{{website}}",
              "description": "Brand website (e.g., samsung.com, apple.com)"
            }
          ]
        },
        "description": "Get brand visibility metrics across LLMs.\n\n**Query Parameters:**\n- `website` (required): Brand name (e.g., Samsung, Coinbase). Case-insensitive lookup.\n\n**Response Structure:**\n```json\n{\n  \"brand_id\": \"uuid\",\n  \"website\": \"Samsung\",\n  \"cached\": false,\n  \"averageMentionRate\": 0.8,\n  \"citations\": 42.7,\n  \"averageSentiment\": 75.0,\n  \"averageRanking\": 2,\n  \"mentionRateByLLM\": {\"chatgpt\": 0.8, \"gemini\": 0.75},\n  \"citationsByLLM\": {\"chatgpt\": 39.2, \"gemini\": 46.2},\n  \"citationOverview\": {\n    \"chatgpt\": [{\"url\": \"https://samsung.com\", \"percentage\": 80.0}, ...],\n    ...\n  },\n  \"rankingOverview\": {\n    \"topBrands\": [{\"brand\": \"apple\", \"rank\": 1}, {\"brand\": \"samsung\", \"rank\": 2}, ...],\n    \"currentBrand\": {\"brand\": \"Samsung\", \"rank\": 2}\n  },\n  \"rankByLLMs\": {\"chatgpt\": 1.5, \"gemini\": 2.0},\n  \"computed_at\": \"2026-01-09T10:30:00Z\"\n}\n```\n\n**Metrics Explained:**\n- `averageMentionRate`: Average mention rate across all LLMs (0.0-1.0)\n- `citations`: Average citation rate as percentage (0-100)\n- `averageSentiment`: Average sentiment score (0-100, higher = more positive)\n- `averageRanking`: Average brand rank rounded up (1 = best)\n- `mentionRateByLLM`: Mention rate per LLM\n- `citationsByLLM`: Citation rate per LLM as percentage (0-100)\n- `citationOverview`: Top 5 cited domains per LLM with percentages\n- `rankingOverview`: Top 7 brands with strict integer ranks (filtered to brands with >= 5% appearance rate)\n- `rankByLLMs`: Brand rank per LLM\n\n**Caching:**\n- Results are cached based on existing metrics in database\n- `cached: true` indicates returned from cache\n- `cached: false` indicates fresh computation\n\n**Status Codes:**\n- 200: Success (may include partial failures for individual LLMs)\n- 400: Missing or invalid website parameter\n- 500: Internal server error"
      },
      "response": [
        {
          "name": "Success - Samsung",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric?website=samsung.com",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric"
              ],
              "query": [
                {
                  "key": "website",
                  "value": "samsung.com"
                }
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"brand_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"website\": \"Samsung\",\n  \"cached\": false,\n  \"averageMentionRate\": 0.528,\n  \"citations\": 42.7,\n  \"averageSentiment\": 66.3,\n  \"averageRanking\": 3,\n  \"mentionRateByLLM\": {\n    \"chatgpt\": 0.517,\n    \"gemini\": 0.538\n  },\n  \"citationsByLLM\": {\n    \"chatgpt\": 39.2,\n    \"gemini\": 46.2\n  },\n  \"sentimentScoreByLLM\": {\n    \"chatgpt\": 61.8,\n    \"gemini\": 70.8\n  },\n  \"citationOverview\": {\n    \"chatgpt\": [\n      {\"url\": \"https://apple.com\", \"percentage\": 41.3},\n      {\"url\": \"https://samsung.com\", \"percentage\": 39.2},\n      {\"url\": \"https://techradar.com\", \"percentage\": 30.3}\n    ],\n    \"gemini\": [\n      {\"url\": \"https://techradar.com\", \"percentage\": 56.5},\n      {\"url\": \"https://apple.com\", \"percentage\": 46.5},\n      {\"url\": \"https://samsung.com\", \"percentage\": 46.2}\n    ]\n  },\n  \"rankingOverview\": {\n    \"topBrands\": [\n      {\"brand\": \"apple\", \"rank\": 1},\n      {\"brand\": \"dell\", \"rank\": 2},\n      {\"brand\": \"samsung\", \"rank\": 3},\n      {\"brand\": \"amazon\", \"rank\": 4},\n      {\"brand\": \"jbl\", \"rank\": 5},\n      {\"brand\": \"garmin\", \"rank\": 6},\n      {\"brand\": \"lg\", \"rank\": 7}\n    ],\n    \"currentBrand\": {\"brand\": \"Samsung\", \"rank\": 3}\n  },\n  \"rankByLLMs\": {\n    \"chatgpt\": 2.44,\n    \"gemini\": 2.8\n  },\n  \"computed_at\": \"2026-01-10T10:30:00Z\"\n}"
        },
        {
          "name": "Success - Cached",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric?website=apple.com",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric"
              ],
              "query": [
                {
                  "key": "website",
                  "value": "apple.com"
                }
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"brand_id\": \"650e8400-e29b-41d4-a716-446655440001\",\n  \"website\": \"Apple\",\n  \"cached\": true,\n  \"averageMentionRate\": 0.925,\n  \"citations\": 85.0,\n  \"averageSentiment\": 86.5,\n  \"averageRanking\": 1,\n  \"mentionRateByLLM\": {\n    \"chatgpt\": 0.95,\n    \"gemini\": 0.9\n  },\n  \"citationsByLLM\": {\n    \"chatgpt\": 80.0,\n    \"gemini\": 85.0\n  },\n  \"sentimentScoreByLLM\": {\n    \"chatgpt\": 85.3,\n    \"gemini\": 88.2\n  },\n  \"citationOverview\": {\n    \"chatgpt\": [\n      {\"url\": \"https://apple.com\", \"percentage\": 95.0},\n      {\"url\": \"https://macrumors.com\", \"percentage\": 70.0}\n    ],\n    \"gemini\": [\n      {\"url\": \"https://apple.com\", \"percentage\": 90.0}\n    ]\n  },\n  \"rankingOverview\": {\n    \"topBrands\": [\n      {\"brand\": \"apple\", \"rank\": 1},\n      {\"brand\": \"samsung\", \"rank\": 2},\n      {\"brand\": \"google\", \"rank\": 3},\n      {\"brand\": \"microsoft\", \"rank\": 4}\n    ],\n    \"currentBrand\": {\"brand\": \"Apple\", \"rank\": 1}\n  },\n  \"rankByLLMs\": {\n    \"chatgpt\": 1.2,\n    \"gemini\": 1.0\n  },\n  \"computed_at\": \"2026-01-10T08:00:00Z\"\n}"
        },
        {
          "name": "Error - Missing Website",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric"
              ]
            }
          },
          "status": "Bad Request",
          "code": 400,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"website parameter is required\"\n}"
        },
        {
          "name": "Error - Internal Server Error",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric?website=example.com",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric"
              ],
              "query": [
                {
                  "key": "website",
                  "value": "example.com"
                }
              ]
            }
          },
          "status": "Internal Server Error",
          "code": 500,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Internal server error\"\n}"
        }
      ]
    },
    {
      "name": "Get Landing Page Metrics",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/metrics/landingPage",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "metrics",
            "landingPage"
          ]
        },
        "description": "Get average mention rates for landing page brands.\n\nReturns average mention rate percentages (0-100) for a fixed list of brands:\n- decathlon\n- leetcode\n- asics\n- zerodha\n- coinbase\n- nothing\n- cult.fit\n\n**Response Structure:**\n```json\n{\n  \"decathlon\": 71.0,\n  \"leetcode\": 23.5,\n  \"asics\": 45.2,\n  \"zerodha\": 68.3,\n  \"coinbase\": 71.0,\n  \"nothing\": 71.0,\n  \"cult.fit\": 71.0\n}\n```\n\n**Notes:**\n- Values are percentages (0-100)\n- If a brand has no data in the database, returns default value of 71.0\n- Average is computed across all LLMs for each brand\n\n**Status Codes:**\n- 200: Success\n- 500: Internal server error"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metrics/landingPage",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metrics",
                "landingPage"
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"asics\": 45.2,\n  \"coinbase\": 71.0,\n  \"cult.fit\": 71.0,\n  \"decathlon\": 71.0,\n  \"leetcode\": 23.5,\n  \"nothing\": 71.0,\n  \"zerodha\": 68.3\n}"
        },
        {
          "name": "Error - Internal Server Error",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metrics/landingPage",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metrics",
                "landingPage"
              ]
            }
          },
          "status": "Internal Server Error",
          "code": 500,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Internal server error\"\n}"
        }
      ]
    },
    {
      "name": "Create Brand Insight Request",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"brand_name\": \"Nike\",\n  \"email\": \"user@example.com\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/brand-insight-request",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "brand-insight-request"
          ]
        },
        "description": "Record a brand insight request from the landing page modal.\n\nThis endpoint stores the request in the database and sends a notification to Slack (if configured via SLACK_WEBHOOK_URL environment variable).\n\n**Request Body (JSON):**\n- `brand_name` (required): Name of the brand\n- `email` (required): User's email address\n\n**Response Structure:**\n```json\n{\n  \"message\": \"Brand insight request recorded successfully\",\n  \"request_id\": \"550e8400-e29b-41d4-a716-446655440000\"\n}\n```\n\n**Slack Notification:**\nIf SLACK_WEBHOOK_URL is configured, a notification with brand_name and email will be sent to the Slack channel. Slack notification failures do not affect the API response.\n\n**Status Codes:**\n- 201: Created successfully\n- 400: Missing required fields\n- 500: Internal server error"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"brand_name\": \"Nike\",\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/brand-insight-request",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "brand-insight-request"
              ]
            }
          },
          "status": "Created",
          "code": 201,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"message\": \"Brand insight request recorded successfully\",\n  \"request_id\": \"550e8400-e29b-41d4-a716-446655440000\"\n}"
        },
        {
          "name": "Error - Missing Brand Name",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/brand-insight-request",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "brand-insight-request"
              ]
            }
          },
          "status": "Bad Request",
          "code": 400,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"brand_name is required\"\n}"
        },
        {
          "name": "Error - Missing Email",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"brand_name\": \"Nike\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/brand-insight-request",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "brand-insight-request"
              ]
            }
          },
          "status": "Bad Request",
          "code": 400,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"email is required\"\n}"
        },
        {
          "name": "Error - Internal Server Error",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"brand_name\": \"Nike\",\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/brand-insight-request",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "brand-insight-request"
              ]
            }
          },
          "status": "Internal Server Error",
          "code": 500,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Internal server error\"\n}"
        }
      ]
    },
    {
      "name": "Get Prompts for Brand",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/metric/prompts?brand_name=Samsung&page=1&per_page=10",
          "host": [
            "{{base_url}}"
          ],
          "path": [
            "metric",
            "prompts"
          ],
          "query": [
            {
              "key": "brand_name",
              "value": "Samsung",
              "description": "Brand name (case-insensitive). Takes precedence over website if both provided."
            },
            {
              "key": "website",
              "value": "{{website}}",
              "description": "Brand website (e.g., samsung.com, case-insensitive). Either brand_name or website is required.",
              "disabled": true
            },
            {
              "key": "page",
              "value": "1",
              "description": "Page number (1-indexed, default: 1)"
            },
            {
              "key": "per_page",
              "value": "10",
              "description": "Items per page (default: 10, max: 100)"
            }
          ]
        },
        "description": "Get prompts for a brand with pagination support.\n\n**Query Parameters:**\n- `brand_name` (optional): Brand name (case-insensitive). Takes precedence over website if both provided.\n- `website` (optional): Brand website (e.g., samsung.com, case-insensitive).\n- `page` (optional): Page number, 1-indexed (default: 1)\n- `per_page` (optional): Items per page (default: 10, max: 100)\n\n**Note:** At least one of `brand_name` or `website` is required. If both are provided, `brand_name` takes precedence.\n\n**Response Structure:**\n```json\n{\n  \"prompts\": [\n    {\"prompt_id\": \"uuid\", \"prompt\": \"What is the best phone under $500?\"},\n    {\"prompt_id\": \"uuid\", \"prompt\": \"Compare Samsung vs Apple cameras\"}\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"per_page\": 10,\n    \"total_items\": 45,\n    \"total_pages\": 5,\n    \"has_next\": true,\n    \"has_prev\": false\n  }\n}\n```\n\n**Status Codes:**\n- 200: Success\n- 400: Missing required parameters or invalid input\n- 404: Brand not found\n- 500: Internal server error"
      },
      "response": [
        {
          "name": "Success - By Brand Name",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric/prompts?brand_name=Samsung&page=1&per_page=10",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric",
                "prompts"
              ],
              "query": [
                {
                  "key": "brand_name",
                  "value": "Samsung"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "per_page",
                  "value": "10"
                }
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"prompts\": [\n    {\"prompt_id\": \"550e8400-e29b-41d4-a716-446655440001\", \"prompt\": \"What is the best smartphone under $500?\"},\n    {\"prompt_id\": \"550e8400-e29b-41d4-a716-446655440002\", \"prompt\": \"Compare Samsung Galaxy vs iPhone cameras\"},\n    {\"prompt_id\": \"550e8400-e29b-41d4-a716-446655440003\", \"prompt\": \"Which brand has the best display technology?\"}\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"per_page\": 10,\n    \"total_items\": 25,\n    \"total_pages\": 3,\n    \"has_next\": true,\n    \"has_prev\": false\n  }\n}"
        },
        {
          "name": "Success - By Website",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric/prompts?website=samsung.com&page=2&per_page=5",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric",
                "prompts"
              ],
              "query": [
                {
                  "key": "website",
                  "value": "samsung.com"
                },
                {
                  "key": "page",
                  "value": "2"
                },
                {
                  "key": "per_page",
                  "value": "5"
                }
              ]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"prompts\": [\n    {\"prompt_id\": \"550e8400-e29b-41d4-a716-446655440006\", \"prompt\": \"Best TV for gaming?\"},\n    {\"prompt_id\": \"550e8400-e29b-41d4-a716-446655440007\", \"prompt\": \"Which brand offers the best warranty?\"}\n  ],\n  \"pagination\": {\n    \"page\": 2,\n    \"per_page\": 5,\n    \"total_items\": 12,\n    \"total_pages\": 3,\n    \"has_next\": true,\n    \"has_prev\": true\n  }\n}"
        },
        {
          "name": "Error - Missing Parameters",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric/prompts",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric",
                "prompts"
              ]
            }
          },
          "status": "Bad Request",
          "code": 400,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Either brand_name or website parameter is required\"\n}"
        },
        {
          "name": "Error - Brand Not Found (by name)",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric/prompts?brand_name=NonExistentBrand",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric",
                "prompts"
              ],
              "query": [
                {
                  "key": "brand_name",
                  "value": "NonExistentBrand"
                }
              ]
            }
          },
          "status": "Not Found",
          "code": 404,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Brand not found for name: NonExistentBrand\"\n}"
        },
        {
          "name": "Error - Brand Not Found (by website)",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/metric/prompts?website=nonexistent.com",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "metric",
                "prompts"
              ],
              "query": [
                {
                  "key": "website",
                  "value": "nonexistent.com"
                }
              ]
            }
          },
          "status": "Not Found",
          "code": 404,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "body": "{\n  \"error\": \"Brand not found for website: nonexistent.com\"\n}"
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "website",
      "value": "samsung.com",
      "type": "string"
    }
  ]
}
